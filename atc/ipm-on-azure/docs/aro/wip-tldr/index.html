<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <meta name="author" content="joseph.tingiris@mastechinfotrellis.com">
  <link rel="canonical" href="https://mitaei.github.io/atc/ipm-on-azure/docs/aro/wip-tldr/">
  <link rel="shortcut icon" href="../img/favicon.ico">
  <title>Too Long; Didn't Read - IPM on Azure</title>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700" />

  <link rel="stylesheet" href="../css/theme.css" />
  <link rel="stylesheet" href="../css/theme_extra.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css" />
  <link href="../css/mit-extra.css" rel="stylesheet" />
  
  <script>
    // Current page data
    var mkdocs_page_name = "Too Long; Didn't Read";
    var mkdocs_page_input_path = "wip-tldr.md";
    var mkdocs_page_url = "/atc/ipm-on-azure/docs/aro/wip-tldr/";
  </script>
  
  <script src="../js/jquery-2.1.1.min.js" defer></script>
  <script src="../js/modernizr-2.8.3.min.js" defer></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script> 
  
  <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-52523818-5', 'mitaei.github.io');
      ga('send', 'pageview');
  </script>
  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
        <a href=".." class="icon icon-home"> IPM on Azure</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../about/">About</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="..">Index</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../tldr/">TLDR</a>
                    </li>
                </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="..">IPM on Azure</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="..">Docs</a> &raquo;</li>
    
      
    
    <li>Too Long; Didn't Read</li>
    <li class="wy-breadcrumbs-aside">
      
    </li>
  </ul>
  
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <h1 id="too-long-didnt-read">Too Long; Didn't Read</h1>
<p>This is a representation of only the commands from the index, using the example environment configuration file from section 4.2.</p>
<p>All descriptions, references, and example outputs have been removed.</p>
<p style="text-align: right"><img align="center" src="img/mit.png"></p>

<p>&nbsp;</p>
<h1 id="azure-red-hat-openshift-for-ibm-product-master">Azure Red Hat OpenShift for IBM Product Master</h1>
<h3 id="draft">[DRAFT]</h3>
<p><em>This document is functional, though still in active development and undergoing frequent changes.</em></p>
<p><em>Revision: Sat 26 Sep 2020 05:16:42 PM EDT</em>
&nbsp;<br></p>
<h4 id="1-azure-tenant">1 - Azure Tenant</h4>
<p><em>1.1 - Create Microsoft Account</em><br></p>
<p><em>1.2 - Create Global Administrator</em><br></p>
<p><em>1.3 - Verify Admin Center Access</em><br></p>
<p><em>1.4 - Verify AAD License</em><br></p>
<h4 id="2-azure-subscription">2 - Azure Subscription</h4>
<p><em>2.1 - Create Azure Subscription</em><br></p>
<h4 id="3-operating-system">3 - Operating System</h4>
<p><em>3.1 - Verify Operating System</em><br></p>
<pre><code class="bash">uname -a
</code></pre>

<p><em>3.2 - Verify GNU bash</em><br></p>
<pre><code class="bash">bash --version
</code></pre>

<p><em>3.3 - Verify GNU awk</em><br></p>
<pre><code class="bash">awk --version
</code></pre>

<p><em>3.4 - Verify GNU coreutils</em><br></p>
<pre><code class="bash">base64 --version
basename --version
dirname --version
sort --version
head --version
tail --version
</code></pre>

<p><em>3.5 - Verify GNU grep</em><br></p>
<pre><code class="bash">egrep --version
</code></pre>

<p><em>3.6 - Verify GNU wget</em><br></p>
<pre><code class="bash">wget --version
</code></pre>

<p><em>3.7 - Verify Browser</em><br></p>
<pre><code class="bash">firefox --version
google-chrome --version
</code></pre>

<p><em>3.8 - Verify OpenSSL</em><br></p>
<pre><code class="bash">openssl version
</code></pre>

<h4 id="4-environment-variables">4 - Environment Variables</h4>
<p><em>4.1 - Unset Environment Variables</em><br></p>
<pre><code class="bash">for ARO in $(env | grep ^ARO | awk -F= &quot;{print \$1}&quot; | sort -V); do echo unset $ARO; unset $ARO; done
</code></pre>

<p><em>4.2 - Set Environment Variables</em><br></p>
<pre><code class="bash">cat &lt;&lt; 'EOF' &gt; &quot;ipm.env&quot;
# NOTE:
#
# These variables may be set statically or dynamically.
#
# This example shows both, static and dynamic variables.
# For the dynamic variables, the order of variables is important
# because many values rely on the value of another variable.
#
# Please check, and double check the values.
#
# Each of these are required.

export ARO=ipm
export ARO_DOMAIN_NAME=mitaei.net
export ARO_ADMINISTRATORS_GROUP_NAME=&quot;OpenShift Administrators&quot;
export ARO_APPLICATION_NAME=${ARO}-app
export ARO_CLUSTER_DOMAIN_NAME=&quot;${ARO}.${ARO_DOMAIN_NAME}&quot;
export ARO_CLUSTER_NAME=${ARO}-cluster
export ARO_CLUSTER_VISIBILITY_API=&quot;Private&quot;
export ARO_CLUSTER_VISIBILITY_INGRESS=&quot;Private&quot;
export ARO_CLUSTER_VM_MASTER_SIZE=&quot;Standard_D8s_v3&quot;
export ARO_CLUSTER_VM_WORKER_COUNT=3
export ARO_CLUSTER_VM_WORKER_DISK_GB=128
export ARO_CLUSTER_VM_WORKER_SIZE=&quot;Standard_D8s_v3&quot;
export ARO_LOCATION_NAME=eastus # region
export ARO_REDHAT_PULL_SECRET_DIR=&quot;${PWD}/secrets&quot;
export ARO_REDHAT_PULL_SECRET_FILE=&quot;${ARO_REDHAT_PULL_SECRET_DIR}/${ARO}-redhat-pull-secret.txt&quot;
export ARO_RESOURCE_GROUP_NAME=&quot;${ARO}-${ARO_LOCATION_NAME}&quot;
export ARO_SERVICE_PRINCIPAL_NAME=&quot;http://${ARO_APPLICATION_NAME}&quot;
export ARO_SERVICE_PRINCIPAL_PASSWORD=&quot;S3rv1c3Pr1cip4lP4ssw0rd!&quot;
export ARO_SUBSCRIPTION_ID=$(az account show --query 'id' --output tsv 2&gt; /dev/null)
export ARO_SUBSCRIPTION_NAME=&quot;Azure subscription for mitaei&quot;
export ARO_TENANT_ID=$(az account show --query 'tenantId' --output tsv 2&gt; /dev/null)
export ARO_TENANT_NAME=${ARO_DOMAIN_NAME}

# CIDRs

# VNet - 10.10.0.0/16
export ARO_VNET_CIDR=10.10.0.0/16
export ARO_VNET_NAME=${ARO}-vnet

# Master - 10.10.0.0/23
export ARO_SUBNET_MASTER_CIDR=10.10.0.0/23
export ARO_SUBNET_MASTER_NAME=${ARO_VNET_NAME}-master-subnet
export ARO_SUBNET_MASTER_NSG_NAME=${ARO_SUBNET_MASTER_NAME}-nsg

# Worker - 10.10.2.0/23
export ARO_SUBNET_WORKER_CIDR=10.10.2.0/23
export ARO_SUBNET_WORKER_NAME=${ARO_VNET_NAME}-worker-subnet
export ARO_SUBNET_WORKER_NSG_NAME=${ARO_SUBNET_WORKER_NAME}-nsg

# Unused - 10.10.4.0/23

# Unused - 10.10.6.0/23

# Unused - 10.10.8.0/23

# VPN Gateway - 10.10.10.0/24
export ARO_SUBNET_VGW_CIDR=10.10.10.0/24
export ARO_SUBNET_VGW_NAME=GatewaySubnet # this MUST be named GatewaySubnet
export ARO_SUBNET_VGW_NSG_NAME=${ARO_SUBNET_VGW_NAME}-nsg

# Application Gateway - 10.10.11.0/24
export ARO_SUBNET_AGW_CIDR=10.10.11.0/24
export ARO_SUBNET_AGW_NAME=${ARO_VNET_NAME}-agw-subnet
export ARO_SUBNET_AGW_NSG_NAME=${ARO_SUBNET_AGW_NAME}-nsg

# Database - 10.10.12.0/24
export ARO_SUBNET_DB_CIDR=10.10.12.0/24
export ARO_SUBNET_DB_NAME=${ARO_VNET_NAME}-db-subnet
export ARO_SUBNET_DB_NSG_NAME=${ARO_SUBNET_DB_NAME}-nsg

# DMZ - 10.10.13.0/24
export ARO_SUBNET_DMZ_CIDR=10.10.13.0/24
export ARO_SUBNET_DMZ_NAME=${ARO_VNET_NAME}-dmz-subnet
export ARO_SUBNET_DMZ_NSG_NAME=${ARO_SUBNET_DMZ_NAME}-nsg

# Trusted 10.10.14.0/24
export ARO_SUBNET_TRUSTED_CIDR=10.10.14.0/24
export ARO_SUBNET_TRUSTED_NAME=${ARO_VNET_NAME}-trusted-subnet
export ARO_SUBNET_TRUSTED_NSG_NAME=${ARO_SUBNET_TRUSTED_NAME}-nsg

# Service - 10.11.0.0/16
export ARO_SUBNET_SERVICE_CIDR=10.11.0.0/16
export ARO_SUBNET_SERVICE_NAME=${ARO_VNET_NAME}-service-subnet
export ARO_SUBNET_SERVICE_NSG_NAME=${ARO_SUBNET_SERVICE_NAME}-nsg

# Pod - 10.12.0.0/14 (must be /18 or larger)
export ARO_SUBNET_POD_CIDR=10.12.0.0/14
export ARO_SUBNET_POD_NAME=${ARO_VNET_NAME}-pod-subnet
export ARO_SUBNET_POD_NSG_NAME=${ARO_SUBNET_POD_NAME}-nsg

# VPN Gateway Pool - 172.16.13.0/24
export ARO_SUBNET_VGW_POOL_CIDR=172.16.13.0/24 # this subnet cannot overlap with the VNet
export ARO_SUBNET_VGW_POOL_NAME=${ARO_VNET_NAME}-vpn-pool-subnet
export ARO_SUBNET_VGW_POOL_NSG_NAME=${ARO_SUBNET_VGW_NAME}-nsg

# VPN Gateway (P2S)
export ARO_VGW_NAME=${ARO}-vpn
export ARO_VGW_PKI_DIR=&quot;${PWD}/pki&quot;
export ARO_VGW_PKI_BITS=2048
export ARO_VGW_PKI_CLIENT='example'
export ARO_VGW_PKI_CLIENT_NAME=&quot;${ARO_VGW_NAME}-client-${ARO_VGW_PKI_CLIENT}&quot;
export ARO_VGW_PKI_CLIENT_CRT_FILE=&quot;${ARO_VGW_PKI_DIR}/${ARO_VGW_PKI_CLIENT_NAME}.crt&quot;
export ARO_VGW_PKI_CLIENT_EXT_FILE=&quot;${ARO_VGW_PKI_DIR}/${ARO_VGW_PKI_CLIENT_NAME}.ext&quot;
export ARO_VGW_PKI_CLIENT_KEY_FILE=&quot;${ARO_VGW_PKI_DIR}/${ARO_VGW_PKI_CLIENT_NAME}.key&quot;
export ARO_VGW_PKI_CLIENT_KEY_FILE_PASSPHRASE='!'&quot;${ARO_VGW_PKI_CLIENT}&quot;'!'
export ARO_VGW_PKI_CLIENT_PFX_FILE=&quot;${ARO_VGW_PKI_DIR}/${ARO_VGW_PKI_CLIENT_NAME}.pfx&quot;
export ARO_VGW_PKI_CLIENT_REQ_FILE=&quot;${ARO_VGW_PKI_DIR}/${ARO_VGW_PKI_CLIENT_NAME}.req&quot;
export ARO_VGW_PKI_CLIENT_SERIAL_FILE=&quot;${ARO_VGW_PKI_DIR}/${ARO_VGW_PKI_CLIENT_NAME}.serial&quot;
export ARO_VGW_PKI_ROOT_CA_SERIAL_FILE=&quot;${ARO_VGW_PKI_DIR}/${ARO_VGW_NAME}-root.serial&quot;
export ARO_VGW_PKI_ROOT_CRT_NAME=&quot;${ARO_VGW_NAME}-root.crt&quot;
export ARO_VGW_PKI_ROOT_CRT_FILE=&quot;${ARO_VGW_PKI_DIR}/${ARO_VGW_PKI_ROOT_CRT_NAME}&quot;
export ARO_VGW_PKI_ROOT_KEY_NAME=&quot;${ARO_VGW_NAME}-root.key&quot;
export ARO_VGW_PKI_ROOT_KEY_FILE=&quot;${ARO_VGW_PKI_DIR}/${ARO_VGW_PKI_ROOT_KEY_NAME}&quot;
export ARO_VGW_PKI_ROOT_KEY_FILE_PASSPHRASE=&quot;Pk1P4ssphr4s3!!&quot;
export ARO_VGW_PUBLIC_ADDRESS_NAME=${ARO_VGW_NAME}-public-ip
export ARO_VGW_REDUNDANCY=true # more costly; set to false for lower environments
export ARO_VGW_SKU=&quot;VpnGw1&quot; # Not Redundant; reverse the order for redundant
export ARO_VGW_SKU=&quot;VpnGw1AZ&quot; # Redundant; reverse the order for not redundant
export ARO_VGW_TYPE=RouteBased

# Additonal, non_ARO VMs
export ARO_VM_JUMP_NAME=${ARO}-vm-jumpbox
export ARO_VM_JUMP_ADMIN_NAME=${ARO_VM_JUMP_NAME}-admin
export ARO_VM_JUMP_IMAGE_MARKETPLACE=true
export ARO_VM_JUMP_IMAGE_URN=&quot;cognosys:docker-ce-with-centos-8-0-free:docker-ce-with-centos-8-0-free:1.2019.0710&quot;
#export ARO_VM_JUMP_IP=$(az vm show -d -g ${ARO_RESOURCE_GROUP_NAME} -n ${ARO_VM_JUMP_NAME} --query publicIps -o tsv)
export ARO_VM_JUMP_PUBLIC_ADDRESS_NAME=${ARO_VM_JUMP_NAME}-public-ip
export ARO_VM_JUMP_SIZE=&quot;Standard_B1ms&quot;

#
# arrays
#

# Microsoft account UPNs for the OpenShift Administrators
export ARO_ADMINISTRATORS=()
export ARO_ADMINISTRATORS+=(openshift-admin@${ARO_DOMAIN_NAME})
export ARO_ADMINISTRATORS+=(arun.babu@mitaei.net)
export ARO_ADMINISTRATORS+=(joseph.tingiris@mitaei.net)
export ARO_ADMINISTRATORS+=(sivaprasad.k@mitaei.net)

# Microsoft Resource Providers needed for ARO
export ARO_RESOURCE_PROVIDERS=()
export ARO_RESOURCE_PROVIDERS+=(Microsoft.Compute)
export ARO_RESOURCE_PROVIDERS+=(Microsoft.RedHatOpenShift)
export ARO_RESOURCE_PROVIDERS+=(Microsoft.Storage)

# Microsoft account UPNs for who will be made Azure Subscription Owners
export ARO_SUBSCRIPTION_OWNERS=()
export ARO_SUBSCRIPTION_OWNERS+=(christy.walsh@mitaei.net)
export ARO_SUBSCRIPTION_OWNERS+=(joseph.tingiris@mitaei.net)

# Microsoft VM Family Quotas that will be verified (to have enough vCPUs for ARO)
export ARO_VERIFY_QUOTA_NAMES=()
export ARO_VERIFY_QUOTA_NAMES+=('Standard DSv3 Family vCPUs')
export ARO_VERIFY_QUOTA_NAMES+=('Standard Dv2 Family vCPUs')

# helpful aliases

alias env_aro='env | grep ^ARO | sort -V'
alias unset_aro='for ARO in $(env | grep ^ARO | awk -F= &quot;{print \$1}&quot; | sort -V); do echo unset $ARO; unset $ARO; done'
EOF
</code></pre>

<pre><code class="bash">cat &quot;ipm.env&quot; &amp;&amp; source &quot;ipm.env&quot;
</code></pre>

<p><em>4.3 - Verify Environment Variables</em><br></p>
<pre><code class="bash">env | grep ^ARO | sort -V
</code></pre>

<h4 id="5-required-directories">5 - Required Directories</h4>
<pre><code class="bash">env | egrep &quot;ARO.*DIR&quot; | sort -V
</code></pre>

<p><em>5.1 - Delete Required Directories</em><br></p>
<pre><code class="bash">rm -rf &quot;${ARO_VGW_PKI_DIR}&quot;
rm -rf &quot;${ARO_REDHAT_PULL_SECRET_DIR}&quot;
</code></pre>

<p><em>5.2 - Verify Required Directories</em><br></p>
<pre><code class="bash">ls -ld &quot;${ARO_VGW_PKI_DIR}&quot;
ls -ld &quot;${ARO_REDHAT_PULL_SECRET_DIR}&quot;
</code></pre>

<h4 id="6-azure-cli">6 - Azure CLI</h4>
<pre><code class="bash">which az
</code></pre>

<p><em>6.1 - Install Azure CLI</em><br></p>
<pre><code class="bash">az --version
</code></pre>

<p><em>6.2 - Subscription Owner Login</em><br></p>
<pre><code class="bash">az login
export AZ_USER=$(az account show --query 'user.name' --output tsv)
az role assignment list --role Owner --query &quot;[?principalName=='${AZ_USER}'].principalName&quot; --output tsv
</code></pre>

<p><em>6.3 - Verify Azure Tenant</em><br></p>
<pre><code class="bash">az account show --query '[{tenantId:tenantId}, {homeTenantId:homeTenantId}]'
export AZ_TENANT_ID=$(az account show --query 'tenantId' --output tsv 2&gt; /dev/null)
if [ &quot;${ARO_TENANT_ID}&quot; != &quot;${AZ_TENANT_ID}&quot; ];then; echo &quot;ERROR! ARO_TENANT_ID (${ARO_TENANT_ID}) does not match this tenant id (${AZ_TENANT_ID})&quot;; fi
</code></pre>

<p><em>6.4 - Verify Default Subscription</em><br></p>
<pre><code class="bash">az account list --query '[?isDefault == `true`]'
</code></pre>

<h4 id="7-subscription-owners">7 - Subscription Owners</h4>
<p><em>7.1 - Delete Subscription Owners</em><br></p>
<p><em>7.2 - Verify Subscription Owners</em><br></p>
<pre><code class="bash">az role assignment list --role Owner --output table
</code></pre>

<h4 id="8-subscription-details">8 - Subscription Details</h4>
<pre><code class="bash">env | egrep -e '^ARO_SUBSCRIPTION_NAME|^ARO_SUBSCRIPTION_ID|^ARO_TENANT_ID|^ARO_LOCATION_NAME'
echo &quot;ARO_SUBSCRIPTION_OWNERS=${ARO_SUBSCRIPTION_OWNERS[@]}&quot;
echo &quot;ARO_VERIFY_QUOTA_NAMES=${ARO_VERIFY_QUOTA_NAMES[@]}&quot;
</code></pre>

<p><em>8.1 - Verify Subscription Name</em><br></p>
<pre><code class="bash">az account list --output table
az account show --subscription &quot;${ARO_SUBSCRIPTION_ID}&quot; --query &quot;[{subscription_name:name},{subscription_id:id}]&quot;
export AZ_SUBSCRIPTION_NAME=$(az account show --query 'name' --output tsv)
if [ &quot;${AZ_SUBSCRIPTION_NAME}&quot; != &quot;${ARO_SUBSCRIPTION_NAME}&quot; ]; then echo &quot;ERROR! az subscription name \&quot;${AZ_SUBSCRIPTION_NAME}\&quot; does not match aro subscription name \&quot;${ARO_SUBSCRIPTION_NAME}\&quot;&quot;; fi
</code></pre>

<p><em>8.2 - Verify Subscription ID</em><br></p>
<pre><code class="bash">az account show --subscription &quot;${ARO_SUBSCRIPTION_ID}&quot; --query &quot;[{subscription_name:name},{subscription_id:id}]&quot;
export AZ_SUBSCRIPTION_ID=$(az account show --query 'id' --output tsv 2&gt; /dev/null)
if [ &quot;${AZ_SUBSCRIPTION_ID}&quot; != &quot;${ARO_SUBSCRIPTION_ID}&quot; ]; then echo &quot;ERROR! az subscription name \&quot;${AZ_SUBSCRIPTION_ID}\&quot; does not match aro subscription name \&quot;${ARO_SUBSCRIPTION_ID}\&quot;&quot;; fi
</code></pre>

<p><em>8.3 - Verify Subscription Location</em><br></p>
<pre><code class="bash">az account list-locations --query &quot;[?name=='${ARO_LOCATION_NAME}']&quot; --output table
export AZ_LOCATION_NAME=$(az account list-locations --query &quot;[?name=='${ARO_LOCATION_NAME}'].name&quot; --output tsv)
if [ &quot;${AZ_LOCATION_NAME}&quot; != &quot;${ARO_LOCATION_NAME}&quot; ]; then echo &quot;ERROR! az location name \&quot;${AZ_LOCATION_NAME}\&quot; does not match aro location name \&quot;${ARO_LOCATION_NAME}\&quot;&quot;; fi
</code></pre>

<p><em>8.4 - Verify Subscription Limits</em><br></p>
<pre><code class="bash">if [ &quot;${ARO_VERIFY_QUOTA_NAMES}&quot; == &quot;&quot; ]; then echo &quot;WARNING! ARO_VERIFY_QUOTA_NAMES is not set&quot;; fi
</code></pre>

<p><em>8.5 - Verify Subscription Quotas</em><br></p>
<p><em>8.6 - Standard DSv3 Family vCPUs</em><br></p>
<pre><code class="bash">az vm list-usage --location ${ARO_LOCATION_NAME} --query &quot;[?localName=='Standard DSv3 Family vCPUs']&quot;
export AZ_VERIFY_QUOTA_LIMIT=$(az vm list-usage --location ${ARO_LOCATION_NAME} --query &quot;[?localName=='Standard DSv3 Family vCPUs'].limit&quot; --output tsv)
if [ &quot;${AZ_VERIFY_QUOTA_LIMIT}&quot; == &quot;&quot; ] || [ ${AZ_VERIFY_QUOTA_LIMIT} -lt 50  ]; then echo &quot;ERROR! Quota limit for &quot;Standard DSv3 Family vCPUs&quot; is too low!  Open a support case with Microsoft.&quot;; fi
</code></pre>

<p><em>8.7 - Standard Dv2 Family vCPUs</em><br></p>
<pre><code class="bash">az vm list-usage --location ${ARO_LOCATION_NAME} --query &quot;[?localName=='Standard Dv2 Family vCPUs']&quot;
export AZ_VERIFY_QUOTA_LIMIT=$(az vm list-usage --location ${ARO_LOCATION_NAME} --query &quot;[?localName=='Standard Dv2 Family vCPUs'].limit&quot; --output tsv)
if [ &quot;${AZ_VERIFY_QUOTA_LIMIT}&quot; == &quot;&quot; ] || [ ${AZ_VERIFY_QUOTA_LIMIT} -lt 50  ]; then echo &quot;ERROR! Quota limit for &quot;Standard Dv2 Family vCPUs&quot; is too low!  Open a support case with Microsoft.&quot;; fi
</code></pre>

<h4 id="9-openshift-administrators">9 - OpenShift Administrators</h4>
<pre><code class="bash">env | egrep -e '^ARO_DOMAIN_NAME'
echo &quot;ARO_ADMINISTRATORS=${ARO_ADMINISTRATORS[@]}&quot;
</code></pre>

<p><em>9.1 - Delete Administrators</em><br></p>
<p><em>9.2 - Delete Administrator Roles</em><br></p>
<p><em>9.3 - Delete Administrator Group</em><br></p>
<p><em>9.4 - Verify Administrators</em><br></p>
<pre><code class="bash">for ARO_ADMINISTRATOR in ${ARO_ADMINISTRATORS[@]}; do az ad user show --id ${ARO_ADMINISTRATOR} --query '[{userPrincipalName:userPrincipalName}, {principalId:objectId}]'; if [ $? -ne 0 ]; then echo &quot;WARNING! ${ADMINISTRATOR} aad account was not found&quot;; fi; done
</code></pre>

<p><em>9.5 - Verify Administrator Roles</em><br></p>
<pre><code class="bash">for ARO_ADMINISTRATOR in ${ARO_ADMINISTRATORS[@]}; do az role assignment list --assignee ${ARO_ADMINISTRATOR} --output table; if [ $? -ne 0 ]; then echo &quot;ERROR! failed retrieving subscription roles for \&quot;${ADMINISTRATOR}\&quot;&quot;; fi; echo; done
</code></pre>

<h4 id="10-resource-providers">10 - Resource Providers</h4>
<pre><code class="bash">echo &quot;ARO_RESOURCE_PROVIDERS=${ARO_RESOURCE_PROVIDERS[@]}&quot;
</code></pre>

<p><em>10.1 - Unregister Provider Microsoft.Compute</em><br></p>
<p><em>10.2 - Unregister Provider Microsoft.RedHatOpenShift</em><br></p>
<p><em>10.3 - Unregister Provider Microsoft.Storage</em><br></p>
<h4 id="11-resource-group">11 - Resource Group</h4>
<pre><code class="bash">env | egrep '^ARO_RESOURCE_GROUP_NAME|^ARO_LOCATION_NAME'
</code></pre>

<p><em>11.1 - Delete Resource Group</em><br></p>
<pre><code class="bash">delete_orphans
az group delete --name ${ARO_RESOURCE_GROUP_NAME --yes
</code></pre>

<p><em>11.2 - Verify Resource Group</em><br></p>
<pre><code class="bash">az group show --name ${ARO_RESOURCE_GROUP_NAME}
</code></pre>

<h4 id="12-virtual-network">12 - Virtual Network</h4>
<pre><code class="bash">env | grep ^ARO_VNET | sort -V
</code></pre>

<p><em>12.1 - Delete Virtual Network</em><br></p>
<pre><code class="bash">az network vnet delete --resource-group ${ARO_RESOURCE_GROUP_NAME} --name ${ARO_VNET_NAME}
</code></pre>

<p><em>12.2 - Verify Virtual Network</em><br></p>
<pre><code class="bash">az network vnet show --resource-group ${ARO_RESOURCE_GROUP_NAME} --name ${ARO_VNET_NAME}
</code></pre>

<h4 id="13-openshift-subnets">13 - OpenShift Subnets</h4>
<pre><code class="bash">env | grep ^ARO_SUBNET | egrep -e 'MASTER|WORKER' | sort -V
</code></pre>

<p><em>13.1 - Delete Master Subnet</em><br></p>
<p><em>13.2 - Delete Worker Subnet</em><br></p>
<p><em>13.3 - Verify Master Subnet</em><br></p>
<pre><code class="bash">az network vnet subnet show --resource-group ${ARO_RESOURCE_GROUP_NAME} --vnet-name ${ARO_VNET_NAME} --name ${ARO_SUBNET_MASTER_NAME} --output table
</code></pre>

<p><em>13.4 - Verify Worker Subnet</em><br></p>
<pre><code class="bash">az network vnet subnet show --resource-group ${ARO_RESOURCE_GROUP_NAME} --vnet-name ${ARO_VNET_NAME} --name ${ARO_SUBNET_WORKER_NAME} --output table
</code></pre>

<h4 id="14-network-security-groups">14 - Network Security Groups</h4>
<pre><code class="bash">env | egrep -e 'ARO_SUBNET(.*)NSG' | egrep -ve 'MASTER|WORKER|VGW' | sort -V
</code></pre>

<p><em>14.1 - Delete Network Security Groups</em><br></p>
<pre><code class="bash">az network nsg delete --resource-group ${ARO_RESOURCE_GROUP_NAME} --name ${ARO_SUBNET_AGW_NSG_NAME}
</code></pre>

<p><em>14.2 - Verify Network Security Groups</em><br></p>
<pre><code class="bash">az network nsg show --resource-group ${ARO_RESOURCE_GROUP_NAME} --name ${ARO_SUBNET_AGW_NSG_NAME} --output table &amp;&amp; echo
az network nsg show --resource-group ${ARO_RESOURCE_GROUP_NAME} --name ${ARO_SUBNET_DB_NSG_NAME} --output table &amp;&amp; echo
az network nsg show --resource-group ${ARO_RESOURCE_GROUP_NAME} --name ${ARO_SUBNET_DMZ_NSG_NAME} --output table &amp;&amp; echo
az network nsg show --resource-group ${ARO_RESOURCE_GROUP_NAME} --name ${ARO_SUBNET_POD_NSG_NAME} --output table &amp;&amp; echo
az network nsg show --resource-group ${ARO_RESOURCE_GROUP_NAME} --name ${ARO_SUBNET_SERVICE_NSG_NAME} --output table &amp;&amp; echo
az network nsg show --resource-group ${ARO_RESOURCE_GROUP_NAME} --name ${ARO_SUBNET_TRUSTED_NSG_NAME} --output table &amp;&amp; echo
</code></pre>

<h4 id="15-network-security-group-rules">15 - Network Security Group Rules</h4>
<pre><code class="bash">env | grep ARO.*NSG | egrep -ve 'MASTER|WORKER|VGW' | sort -V
</code></pre>

<p><em>15.1 - Delete DMZ NSG Rule (AllowSSH)</em><br></p>
<p><em>15.2 - Verify DMZ NSG Rules</em><br></p>
<pre><code class="bash">az network nsg show --resource-group ${ARO_RESOURCE_GROUP_NAME} --name ${ARO_SUBNET_DMZ_NSG_NAME} --query securityRules --output table
</code></pre>

<h4 id="16-related-subnets">16 - Related Subnets</h4>
<pre><code class="bash">env | grep ^ARO_SUBNET | egrep -ve 'MASTER|WORKER|VGW' | sort -V
</code></pre>

<p><em>16.1 - Delete Application Gateway Subnet</em><br></p>
<pre><code class="bash">az network vnet subnet delete --resource-group ${ARO_RESOURCE_GROUP_NAME} --vnet-name ${ARO_VNET_NAME} --name ${ARO_SUBNET_AGW_NAME}
</code></pre>

<p><em>16.2 - Delete Database Subnet</em><br></p>
<pre><code class="bash">az network vnet subnet delete --resource-group ${ARO_RESOURCE_GROUP_NAME} --vnet-name ${ARO_VNET_NAME} --name ${ARO_SUBNET_DB_NAME}
</code></pre>

<p><em>16.3 - Delete DMZ Subnet</em><br></p>
<pre><code class="bash">az network vnet subnet delete --resource-group ${ARO_RESOURCE_GROUP_NAME} --vnet-name ${ARO_VNET_NAME} --name ${ARO_SUBNET_DMZ_NAME}
</code></pre>

<p><em>16.4 - Delete Trusted Subnet</em><br></p>
<pre><code class="bash">az network vnet subnet delete --resource-group ${ARO_RESOURCE_GROUP_NAME} --vnet-name ${ARO_VNET_NAME} --name ${ARO_SUBNET_TRUSTED_NAME}
</code></pre>

<p><em>16.5 - Verify Application Gateway Subnet</em><br></p>
<pre><code class="bash">az network vnet subnet show --resource-group ${ARO_RESOURCE_GROUP_NAME} --vnet-name ${ARO_VNET_NAME} --name ${ARO_SUBNET_AGW_NAME} --output table
</code></pre>

<p><em>16.6 - Verify Database Subnet</em><br></p>
<pre><code class="bash">az network vnet subnet show --resource-group ${ARO_RESOURCE_GROUP_NAME} --vnet-name ${ARO_VNET_NAME} --name ${ARO_SUBNET_DB_NAME} --output table
</code></pre>

<p><em>16.7 - Verify DMZ Subnet</em><br></p>
<pre><code class="bash">az network vnet subnet show --resource-group ${ARO_RESOURCE_GROUP_NAME} --vnet-name ${ARO_VNET_NAME} --name ${ARO_SUBNET_DMZ_NAME} --output table
</code></pre>

<p><em>16.8 - Verify Trusted Subnet</em><br></p>
<pre><code class="bash">az network vnet subnet show --resource-group ${ARO_RESOURCE_GROUP_NAME} --vnet-name ${ARO_VNET_NAME} --name ${ARO_SUBNET_TRUSTED_NAME} --output table
</code></pre>

<h4 id="17-jump-server-vm">17 - Jump Server VM</h4>
<pre><code class="bash">env | egrep ARO.*JUMP | sort -V
</code></pre>

<p><em>17.1 - Delete Jump Server VM</em><br></p>
<pre><code class="bash">az vm delete --resource-group ${ARO_RESOURCE_GROUP_NAME} --name ${ARO_VM_JUMP_NAME} --yes
</code></pre>

<p><em>17.2 - Cancel Jump Server Image URN</em><br></p>
<pre><code class="bash">az vm image terms cancel --urn ${ARO_VM_JUMP_IMAGE_URN}
</code></pre>

<p><em>17.3 - Delete Jump Server AS</em><br></p>
<pre><code class="bash">az vm availability-set delete --resource-group ${ARO_RESOURCE_GROUP_NAME} --name ${ARO_VM_JUMP_NAME}
</code></pre>

<p><em>17.4 - Delete Jump Server NIC</em><br></p>
<pre><code class="bash">az network nic delete --resource-group ${ARO_RESOURCE_GROUP_NAME} --name ${ARO_VM_JUMP_NAME}-nic
</code></pre>

<p><em>17.5 - Delete Jump Server Address</em><br></p>
<pre><code class="bash">az network public-ip delete --name ${ARO_VM_JUMP_PUBLIC_ADDRESS_NAME} --resource-group ${ARO_RESOURCE_GROUP_NAME}
</code></pre>

<p><em>17.6 - Verify Jump Server Address</em><br></p>
<pre><code class="bash">az network public-ip show --name ${ARO_VM_JUMP_PUBLIC_ADDRESS_NAME} --resource-group ${ARO_RESOURCE_GROUP_NAME}
</code></pre>

<p><em>17.7 - Verify Jump Server NIC</em><br></p>
<pre><code class="bash">az network nic show --resource-group ${ARO_RESOURCE_GROUP_NAME} --name ${ARO_VM_JUMP_NAME}-nic --output table
</code></pre>

<p><em>17.8 - Verify Jump Server AS</em><br></p>
<pre><code class="bash">az vm availability-set show --resource-group ${ARO_RESOURCE_GROUP_NAME} --name ${ARO_VM_JUMP_NAME}-as --output table
</code></pre>

<p><em>17.9 - Verify Jump Server Image URN</em><br></p>
<pre><code class="bash">az vm image terms show --urn ${ARO_VM_JUMP_IMAGE_URN} --query '[{accepted:accepted, name:name, plan:plan, product:product, publisher:publisher, type:type}]' --output table
</code></pre>

<p><em>17.10 - Verify Jump Server VM</em><br></p>
<pre><code class="bash">az vm show -d -g ${ARO_RESOURCE_GROUP_NAME} -n ${ARO_VM_JUMP_NAME} --query publicIps -o tsv
az vm show --resource-group ${ARO_RESOURCE_GROUP_NAME} --name ${ARO_VM_JUMP_NAME}
</code></pre>

<p><em>17.11 - Login to Jump Server VM</em><br></p>
<pre><code class="bash">export ARO_VM_JUMP_IP=$(az vm show -d -g ${ARO_RESOURCE_GROUP_NAME} -n ${ARO_VM_JUMP_NAME} --query publicIps -o tsv)
echo &quot;${ARO_VM_JUMP_IP}&quot;
ssh -i ~/.ssh/id_rsa.pub ${ARO_VM_JUMP_ADMIN_NAME}@${ARO_VM_JUMP_IP} &quot;hostname &amp;&amp; uptime&quot;
</code></pre>

<h4 id="18-vpn-gateway">18 - VPN Gateway</h4>
<pre><code class="bash">env | egrep ARO.*VGW | egrep -ve 'PKI' | sort -V
</code></pre>

<p><em>18.1 - Delete VPN Gateway</em><br></p>
<pre><code class="bash">az network vnet-gateway delete --name ${ARO_VGW_NAME} --resource-group ${ARO_RESOURCE_GROUP_NAME}
</code></pre>

<p><em>18.2 - Delete VPN Address</em><br></p>
<pre><code class="bash">az network public-ip delete --name ${ARO_VGW_PUBLIC_ADDRESS_NAME} --resource-group ${ARO_RESOURCE_GROUP_NAME}
</code></pre>

<p><em>18.3 - Delete VPN Subnet</em><br></p>
<pre><code class="bash">az network vnet subnet delete --resource-group ${ARO_RESOURCE_GROUP_NAME} --vnet-name ${ARO_VNET_NAME} --name ${ARO_SUBNET_VGW_NAME}
</code></pre>

<p><em>18.4 - Verify VPN Subnet</em><br></p>
<pre><code class="bash">az network vnet subnet show --resource-group ${ARO_RESOURCE_GROUP_NAME} --vnet-name ${ARO_VNET_NAME} --name ${ARO_SUBNET_VGW_NAME} --output table
</code></pre>

<p><em>18.5 - Verify VPN Address</em><br></p>
<pre><code class="bash">az network public-ip show --name ${ARO_VGW_PUBLIC_ADDRESS_NAME} --resource-group ${ARO_RESOURCE_GROUP_NAME} --output table
</code></pre>

<p><em>18.6 - Verify VPN Gateway</em><br></p>
<pre><code class="bash">az network vnet-gateway show --name ${ARO_VGW_NAME} --resource-group ${ARO_RESOURCE_GROUP_NAME} --output table
</code></pre>

<h4 id="19-vpn-gateway-pki">19 - VPN Gateway PKI</h4>
<pre><code class="bash">env | grep ARO_VGW_PKI | grep -v CLIENT | sort -V
</code></pre>

<p><em>19.1 - Delete Root Certificate</em><br></p>
<pre><code class="bash">rm -f &quot;${ARO_VGW_PKI_ROOT_CRT_FILE}&quot;
</code></pre>

<p><em>19.2 - Delete Root Key</em><br></p>
<pre><code class="bash">rm -f &quot;${ARO_VGW_PKI_ROOT_KEY_FILE}&quot;
</code></pre>

<p><em>19.3 - Verify Root Key</em><br></p>
<pre><code class="bash">openssl rsa -in ${ARO_VGW_PKI_ROOT_KEY_FILE} -noout -passin env:ARO_VGW_PKI_ROOT_KEY_FILE_PASSPHRASE 2&gt;&amp;1
</code></pre>

<p><em>19.4 - Verify Root Certificate</em><br></p>
<pre><code class="bash">openssl x509 -in &quot;${ARO_VGW_PKI_ROOT_CRT_FILE}&quot; -noout -text 2&gt;&amp;1
</code></pre>

<p><em>19.5 - Verify Root  Moduli</em><br></p>
<pre><code class="bash">echo -n &quot;md5sum for ${ARO_VGW_PKI_ROOT_KEY_FILE} = &quot;; openssl rsa -noout -modulus -in &quot;${ARO_VGW_PKI_ROOT_KEY_FILE}&quot; -passin env:ARO_VGW_PKI_ROOT_KEY_FILE_PASSPHRASE | md5sum
echo -n &quot;md5sum for ${ARO_VGW_PKI_ROOT_CRT_FILE} = &quot;; openssl x509 -noout -modulus -in &quot;${ARO_VGW_PKI_ROOT_CRT_FILE}&quot; | md5sum
</code></pre>

<p><em>19.6 - Verify Root Data</em><br></p>
<pre><code class="bash">AZ_UPLOAD_OK=false; while read AZ_VERIFY_CERTIFICATE_NAME; do echo &quot;found ${ARO_VGW_NAME} root certificate name = ${AZ_VERIFY_CERTIFICATE_NAME}&quot;; if [ &quot;${AZ_VERIFY_CERTIFICATE_NAME}&quot; == &quot;${ARO_VGW_PKI_ROOT_CRT_NAME}&quot; ]; then AZ_UPLOAD_OK=true; fi; done &lt;&lt;&lt; &quot;$(az network vnet-gateway show --name ${ARO_VGW_NAME} --resource-group ${ARO_RESOURCE_GROUP_NAME} --query vpnClientConfiguration.vpnClientRootCertificates[].[name] --output tsv)&quot;; if ${AZ_UPLOAD_OK}; then echo &quot;verified ${ARO_VGW_PKI_ROOT_CRT_NAME} exists as a root certificate name for ${ARO_VGW_NAME}&quot;; else echo &quot;failed to verify ${ARO_VGW_PKI_ROOT_CRT_NAME} exists as a root certificate name for ${ARO_VGW_NAME}&quot;; fi
</code></pre>

<h4 id="20-client-certificates">20 - Client Certificates</h4>
<p><em>20.1 - Set VPN Client Environment Variables</em><br></p>
<pre><code class="bash">export ARO_VGW_PKI_CLIENT='example'
export ARO_VGW_PKI_CLIENT_NAME=&quot;${ARO_VGW_NAME}-client-${ARO_VGW_PKI_CLIENT}&quot;
export ARO_VGW_PKI_CLIENT_EXT_FILE=&quot;${ARO_VGW_PKI_DIR}/${ARO_VGW_PKI_CLIENT_NAME}.ext&quot;
export ARO_VGW_PKI_CLIENT_KEY_FILE=&quot;${ARO_VGW_PKI_DIR}/${ARO_VGW_PKI_CLIENT_NAME}.key&quot;
export ARO_VGW_PKI_CLIENT_KEY_FILE_PASSPHRASE='!'&quot;${ARO_VGW_PKI_CLIENT}&quot;'!'
export ARO_VGW_PKI_CLIENT_REQ_FILE=&quot;${ARO_VGW_PKI_DIR}/${ARO_VGW_PKI_CLIENT_NAME}.req&quot;
export ARO_VGW_PKI_CLIENT_CRT_FILE=&quot;${ARO_VGW_PKI_DIR}/${ARO_VGW_PKI_CLIENT_NAME}.crt&quot;
export ARO_VGW_PKI_CLIENT_SERIAL_FILE=&quot;${ARO_VGW_PKI_DIR}/${ARO_VGW_PKI_CLIENT_NAME}.serial&quot;
export ARO_VGW_PKI_CLIENT_PFX_FILE='${ARO_VGW_PKI_DIR}/${ARO_VGW_PKI_CLIENT_NAME}.pfx'
</code></pre>

<p><em>20.2 - Verify VPN Client Environment Variables</em><br></p>
<pre><code class="bash">ARO_VERIFY_VARIABLES=(ARO_VGW_PKI_CLIENT_NAME ARO_VGW_PKI_CLIENT_EXT_FILE ARO_VGW_PKI_CLIENT_KEY_FILE ARO_VGW_PKI_CLIENT_KEY_FILE_PASSPHRASE ARO_VGW_PKI_CLIENT_REQ_FILE ARO_VGW_PKI_CLIENT_CRT_FILE ARO_VGW_PKI_CLIENT_SERIAL_FILE ARO_VGW_PKI_CLIENT_PFX_FILE ARO_VGW_NAME ARO_VGW_PKI_BITS ARO_VGW_PKI_DIR ARO_VGW_PKI_ROOT_KEY_FILE ARO_VGW_PKI_ROOT_KEY_FILE_PASSPHRASE)
for ARO_VERIFY_VARIABLE in ${ARO_VERIFY_VARIABLES[@]}; do if [ &quot;${!ARO_VERIFY_VARIABLE}&quot; == &quot;&quot; ]; then echo &quot;ERROR! Environment Variable ${ARO_VERIFY_VARIABLE} is NOT set&quot;; else echo &quot;${ARO_VERIFY_VARIABLE}=${!ARO_VERIFY_VARIABLE}&quot;; fi; done; unset ARO_VERIFY_VARIABLE
</code></pre>

<p><em>20.3 - Delete VPN Client Key</em><br></p>
<pre><code class="bash">rm -f &quot;${ARO_VGW_PKI_CLIENT_KEY_FILE}&quot;
</code></pre>

<p><em>20.4 - Delete Client Certificate Request</em><br></p>
<pre><code class="bash">rm -f &quot;${ARO_VGW_PKI_CLIENT_REQ_FILE}&quot;
</code></pre>

<p><em>20.5 - Delete Client Certificate Extensions</em><br></p>
<pre><code class="bash">rm -f &quot;${ARO_VGW_PKI_CLIENT_EXT_FILE}&quot;
</code></pre>

<p><em>20.6 - Delete Client Certificate</em><br></p>
<pre><code class="bash">rm -f &quot;${ARO_VGW_PKI_CLIENT_CRT_FILE}&quot;
</code></pre>

<p><em>20.7 - Delete VPN Client Serial</em><br></p>
<pre><code class="bash">rm -f &quot;${ARO_VGW_PKI_CLIENT_SERIAL_FILE}&quot;
</code></pre>

<p><em>20.8 - Delete VPN Client PFX</em><br></p>
<pre><code class="bash">rm &quot;${ARO_VGW_PKI_CLIENT_PFX_FILE}&quot;
</code></pre>

<p><em>20.9 - Verify VPN Client Key</em><br></p>
<pre><code class="bash">openssl rsa -in &quot;${ARO_VGW_PKI_CLIENT_KEY_FILE}&quot; -noout -passin env:ARO_VGW_PKI_CLIENT_KEY_FILE_PASSPHRASE 2&gt;&amp;1
</code></pre>

<p><em>20.10 - Verify Client Certificate Request</em><br></p>
<pre><code class="bash">openssl req -in &quot;${ARO_VGW_PKI_CLIENT_REQ_FILE}&quot; -noout -text 2&gt;&amp;1
</code></pre>

<p><em>20.11 - Verify Client Certificate Extensions</em><br></p>
<pre><code class="bash">grep ^authorityKeyIdentifier=keyid,issuer &quot;${ARO_VGW_PKI_CLIENT_EXT_FILE}&quot; &amp;&amp; grep ^extendedKeyUsage=clientAuth &quot;${ARO_VGW_PKI_CLIENT_EXT_FILE}&quot;
</code></pre>

<p><em>20.12 - Verify Client Certificate</em><br></p>
<pre><code class="bash">openssl x509 -in &quot;${ARO_VGW_PKI_CLIENT_CRT_FILE}&quot; -noout -text 2&gt;&amp;1
</code></pre>

<p><em>20.13 - Verify Client  Moduli</em><br></p>
<pre><code class="bash">echo -n &quot;md5sum for ${ARO_VGW_PKI_CLIENT_KEY_FILE} = &quot;; openssl rsa -noout -modulus -in &quot;${ARO_VGW_PKI_CLIENT_KEY_FILE}&quot; -passin env:ARO_VGW_PKI_CLIENT_KEY_FILE_PASSPHRASE | md5sum
echo -n &quot;md5sum for ${ARO_VGW_PKI_CLIENT_CRT_FILE} = &quot;; openssl x509 -noout -modulus -in &quot;${ARO_VGW_PKI_CLIENT_CRT_FILE}&quot; | md5sum
echo -n &quot;md5sum for ${ARO_VGW_PKI_CLIENT_REQ_FILE} = &quot;; openssl req -noout -modulus -in &quot;${ARO_VGW_PKI_CLIENT_REQ_FILE}&quot; | md5sum
</code></pre>

<p><em>20.14 - Verify VPN Client PFX</em><br></p>
<pre><code class="bash">openssl x509 -in &quot;${ARO_VGW_PKI_CLIENT_PFX_FILE}&quot; -noout -text 2&gt;&amp;1
</code></pre>

<h4 id="21-vpn-client">21 - VPN Client</h4>
<pre><code class="bash">env | egrep -e &quot;ARO.*PKI_CLIENT|ARO_VGW_NAME|ARO_VGW_PKI_BITS|ARO_VGW_PKI_DIR|ARO_VGW_PKI_ROOT_KEY&quot; | sort -V
</code></pre>

<p><em>21.1 - Delete VPN Client</em><br></p>
<pre><code class="bash">rm -f &quot;${ARO_VGW_PKI_DIR}/${ARO_VGW_NAME}.zip&quot;
</code></pre>

<p><em>21.2 - Verify VPN Client URL</em><br></p>
<pre><code class="bash">export ARO_VGW_CONFIGURATION_URL=$(az network vnet-gateway vpn-client generate -g ${ARO_RESOURCE_GROUP_NAME} -n ${ARO_VGW_NAME} --processor-architecture Amd64)
echo &quot;ARO_VGW_CONFIGURATION_URL=${ARO_VGW_CONFIGURATION_URL}&quot;
</code></pre>

<h4 id="22-obtain-pull-secrets">22 - Obtain Pull Secrets</h4>
<p><em>22.1 - Obtain Red Hat Pull Secret</em><br></p>
<p><em>22.2 - Verify Red Hat Pull Secret</em><br></p>
<pre><code class="bash">ls -ld &quot;${ARO_REDHAT_PULL_SECRET_FILE}&quot;
</code></pre>

<h4 id="23-azure-red-hat-openshift">23 - Azure Red Hat OpenShift</h4>
<pre><code class="bash">env | egrep -e 'ARO_CLUSTER|ARO_REDHAT_PULL_SECRET_FILE|ARO_RESOURCE_GROUP_NAME|ARO_VNET_NAME|ARO_SUBNET_MASTER_NAME|ARO_SUBNET_WORKER_NAME' | sort -V
</code></pre>

<p><em>23.1 - Delete ARO Cluster</em><br></p>
<pre><code class="bash">az aro delete --resource-group ${ARO_RESOURCE_GROUP_NAME} --name ${ARO_CLUSTER_NAME} --yes
</code></pre>

<p><em>23.2 - Verify ARO Cluster</em><br></p>
<pre><code class="bash">az aro show --name &quot;${ARO_CLUSTER_NAME}&quot; --resource-group &quot;${ARO_RESOURCE_GROUP_NAME}&quot; --query consoleProfile.url --output tsv
az aro show --name &quot;${ARO_CLUSTER_NAME}&quot; --resource-group &quot;${ARO_RESOURCE_GROUP_NAME}&quot;
az aro list-credentials --name &quot;${ARO_CLUSTER_NAME}&quot; --resource-group &quot;${ARO_RESOURCE_GROUP_NAME}&quot;
</code></pre>

<h4 id="24-openshift-cli">24 - OpenShift CLI</h4>
<p><em>24.1 - Verify OpenShift CLI</em><br></p>
<pre><code class="bash">oc version
kubectl version
</code></pre>

<h4 id="25-openshift-authentication">25 - OpenShift Authentication</h4>
              
            </div>
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
      <p>&copy; 2020 Mastech InfoTrellis</p>
    
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
      
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="versions">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
      
      
    </span>
</div>
    <script>var base_url = '..';</script>
    <script src="../js/theme.js" defer></script>
      <script src="../search/main.js" defer></script>
    <script defer>
        window.onload = function () {
            SphinxRtdTheme.Navigation.enable(true);
        };
    </script>

</body>
</html>
